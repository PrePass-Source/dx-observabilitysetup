# Mimir configuration for local development
# Based on: https://grafana.com/docs/mimir/latest/operators-guide/configuration/

# Server configuration
server:
  http_listen_port: 9009
  grpc_listen_port: 9095

# Multi-tenancy (disabled for local dev)
multitenancy_enabled: false

# Ingester configuration
ingester:
  ring:
    kvstore:
      store: memberlist
    replication_factor: 1
  max_global_series_per_user: 1000000
  max_global_series_per_metric: 100000
  max_global_exemplars_per_user: 10000

# Distributor configuration
distributor:
  ring:
    kvstore:
      store: memberlist
    replication_factor: 1
  # OTLP receiver configuration
  otlp:
    grpc:
      enabled: true
      port: 4317
    http:
      enabled: true
      port: 4318

# Compactor configuration
compactor:
  sharding_ring:
    kvstore:
      store: memberlist
    replication_factor: 1
  compaction_interval: 1h
  retention_enabled: true
  retention_delete_delay: 2h
  retention_delete_worker_count: 150

# Store-gateway configuration
store_gateway:
  sharding_ring:
    kvstore:
      store: memberlist
    replication_factor: 1

# Querier configuration
querier:
  query_timeout: 2m
  max_concurrent: 20

# Query-frontend configuration
query_frontend:
  downstream_url: http://localhost:9009

# Ruler configuration
ruler:
  ring:
    kvstore:
      store: memberlist
    replication_factor: 1
  rule_path: /data/rules

# Alertmanager configuration
alertmanager:
  sharding_ring:
    kvstore:
      store: memberlist
    replication_factor: 1
  data_dir: /data/alertmanager

# Storage configuration
storage:
  engine: blocks
  tsdb:
    dir: /data/tsdb
    retention_period: 7d

# Memberlist configuration (for service discovery)
memberlist:
  join_members: []
  bind_addr: ['0.0.0.0']
  bind_port: 7946
  gossip_interval: 2s
  dead_node_reclaim_time: 30s

# Limits configuration
limits:
  max_global_series_per_user: 1000000
  max_global_series_per_metric: 100000
  max_global_exemplars_per_user: 10000
  ingestion_rate: 10000
  ingestion_burst_size: 20000
  max_query_length: 721h
  max_query_parallelism: 32
  max_cache_freshness_per_query: 10m
  split_queries_by_interval: 24h
  max_queriers_per_tenant: 10
  query_timeout: 2m
  ruler_max_rules_per_rule_group: 20
  ruler_max_rule_groups_per_tenant: 70

# Logging configuration
log:
  level: info
  format: logfmt

# Metrics configuration
metrics:
  register_instrumentation: true
  log_queries_longer_than: 5s

# Tracing configuration
tracing:
  enabled: false 